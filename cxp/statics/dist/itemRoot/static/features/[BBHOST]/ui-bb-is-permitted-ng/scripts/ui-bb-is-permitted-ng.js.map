{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6*********************","webpack:///webpack/bootstrap 16ce69979da567ada154?cec8*********************","webpack:///./ui-bb-is-permitted-ng/model.xml","webpack:///external \"vendor-bb-angular\"?a114*********************","webpack:///./ui-bb-is-permitted-ng/scripts/index.js","webpack:///external \"lib-bb-permissions-ng\"","webpack:///./ui-bb-is-permitted-ng/scripts/directive.js"],"names":["angular","module","permissionsModuleKey","directive","bbPermissionsKey","name","getBlockNodes","node","nodes","endNode","length","blockNodes","i","nextSibling","element","slice","call","push","linkFnFactory","$animate","$compile","permissions","$scope","$element","$attr","ctrl","$transclude","block","childScope","previousElements","showElement","clone","newScope","$$createComment","bbIsPermittedNg","enter","parent","hideElement","remove","$destroy","leave","then","checkPermissions","isPermitted","privilege","catch","console","warn","$watch","enabled","value","multiElement","transclude","priority","terminal","restrict","$$tlb","link"],"mappings":"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","file":"ui-bb-is-permitted-ng/scripts/ui-bb-is-permitted-ng.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vendor-bb-angular\"), require(\"lib-bb-permissions-ng\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"ui-bb-is-permitted-ng\", [\"vendor-bb-angular\", \"lib-bb-permissions-ng\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ui-bb-is-permitted-ng\"] = factory(require(\"vendor-bb-angular\"), require(\"lib-bb-permissions-ng\"));\n\telse\n\t\troot[\"ui-bb-is-permitted-ng\"] = factory(root[\"vendor-bb-angular\"], root[\"lib-bb-permissions-ng\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_88__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 16ce69979da567ada154","module.exports = require(\"./scripts/index.js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ui-bb-is-permitted-ng/model.xml\n// module id = 0\n// module chunks = 22","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"vendor-bb-angular\"\n// module id = 2\n// module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41","/**\n * @module ui-bb-is-permitted-ng\n *\n * @description\n * This module contains UI directive to show/hide element it applied to\n * depending on user permissions. Directive behaves much as same as Angular's ng-if\n * directive (and it actually contains it's original code), so element will be hidden\n * or shown depending user permissions.\n * To download and check user permissions directive use lib-bb-permissions-ng library.\n *\n * @example\n * // Add module dependency in the extension's index.js\n * import uiBbIsPermittedNg from 'ui-bb-is-permitted-ng';\n *\n * export const dependencyKeys = [\n *   uiBbIsPermittedNg,\n * ];\n *\n * // Add directive attribute to html elements in the extensions's template.html\n * <button class=\"btn\"\n *   data-ng-click=\"$ctrl.createContact()\"\n *   data-bb-is-permitted-ng=\"'Contacts.Contacts.create'\">\n *   Create new Contact\n * </button>\n */\n\nimport angular from 'vendor-bb-angular';\nimport permissionsModuleKey, { bbPermissionsKey } from 'lib-bb-permissions-ng';\n\nimport directive from './directive';\n\nexport default angular\n  .module('ui-bb-is-permitted-ng', [\n    permissionsModuleKey,\n  ])\n  .directive('bbIsPermittedNg', [\n    '$animate',\n    '$compile',\n    bbPermissionsKey,\n    /* into */\n    directive,\n  ])\n  .name;\n\n\n\n// WEBPACK FOOTER //\n// ./ui-bb-is-permitted-ng/scripts/index.js","module.exports = __WEBPACK_EXTERNAL_MODULE_88__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-permissions-ng\"\n// module id = 88\n// module chunks = 22","import angular from 'vendor-bb-angular';\n\n/**\n * @name getBlockNodes\n * @type {function}\n * @inner\n * @description\n * Return the DOM siblings between the first and last node in the given array.\n * This method is copied from AngularJS library as part of ng-if directive implementation.\n * https://github.com/angular/angular.js/blob/v1.5.8/src/Angular.js#L1876\n *\n * @param {object[]} nodes Array like object\n * @returns {object[]} The inputted object or a jqLite collection containing the nodes\n */\nconst getBlockNodes = nodes => {\n  let node = nodes[0];\n  const endNode = nodes[nodes.length - 1];\n  let blockNodes;\n\n  // eslint-disable-next-line no-cond-assign\n  for (let i = 1; node !== endNode && (node = node.nextSibling); i++) {\n    if (blockNodes || nodes[i] !== node) {\n      if (!blockNodes) {\n        blockNodes = angular.element([].slice.call(nodes, 0, i));\n      }\n      blockNodes.push(node);\n    }\n  }\n  return blockNodes || nodes;\n};\n\n/**\n * @type {function}\n * @description\n * Directive's link function factory\n * @inner\n */\nconst linkFnFactory = ($animate, $compile, permissions) =>\n  ($scope, $element, $attr, ctrl, $transclude) => {\n    let block;\n    let childScope;\n    let previousElements;\n\n    /**\n     * @name showElement\n     * @type {function}\n     * @inner\n     * @description\n     * Add element to the DOM\n     * Implementation of this function is taken from the original ng-if directive code.\n     * https://github.com/angular/angular.js/blob/v1.5.8/src/ng/directive/ngIf.js#L94\n     */\n    const showElement = () => {\n      if (!childScope) {\n        $transclude((clone, newScope) => {\n          childScope = newScope;\n          // eslint-disable-next-line no-param-reassign\n          clone[clone.length++] = $compile\n            .$$createComment('end bbIsPermittedNg', $attr.bbIsPermittedNg);\n          // Note: We only need the first/last node of the cloned nodes.\n          // However, we need to keep the reference to the jqlite wrapper as it might be\n          // changed later by a directive with templateUrl when its template arrives.\n          block = { clone };\n          $animate.enter(clone, $element.parent(), $element);\n        });\n      }\n    };\n\n    /**\n     * @name hideElement\n     * @type {function}\n     * @inner\n     * @description\n     * Removes directive element from the DOM\n     * Implementation of this function is taken from the original ng-if directive code.\n     * https://github.com/angular/angular.js/blob/v1.5.8/src/ng/directive/ngIf.js#L108\n     */\n    const hideElement = () => {\n      if (previousElements) {\n        previousElements.remove();\n        previousElements = null;\n      }\n\n      if (childScope) {\n        childScope.$destroy();\n        childScope = null;\n      }\n\n      if (block) {\n        previousElements = getBlockNodes(block.clone);\n        $animate.leave(previousElements)\n          .then(() => {\n            previousElements = null;\n          });\n        block = null;\n      }\n    };\n\n    /**\n     * @name checkPermissions\n     * @type {function}\n     * @inner\n     * @description\n     * Will check user permissions for specified privilege and either show\n     * or hide element depending on the result. If permissions check failed,\n     * element will be hidden too.\n     * @param {string} privilege Privilege string to check permissions for.\n     */\n    const checkPermissions = privilege => {\n      permissions.isPermitted(privilege)\n        .then(isPermitted => {\n          if (isPermitted) {\n            showElement();\n          } else {\n            hideElement();\n          }\n        })\n        .catch(() => {\n          // eslint-disable-next-line no-console\n          console.warn(`Unable to download user permissions for \"${privilege}\" privilege.`);\n          hideElement();\n        });\n    };\n\n    $scope.$watch($attr.bbIsPermittedNg, value => {\n      if (!permissions.enabled) {\n        showElement();\n      } else {\n        checkPermissions(value);\n      }\n    });\n  };\n\n/**\n * @name bbIsPermittedNgDirective\n * @type {object}\n */\nexport default ($animate, $compile, permissions) => ({\n  multiElement: true,\n  transclude: 'element',\n  priority: 700,\n  terminal: true,\n  restrict: 'A',\n  $$tlb: true,\n  link: linkFnFactory($animate, $compile, permissions),\n});\n\n\n\n// WEBPACK FOOTER //\n// ./ui-bb-is-permitted-ng/scripts/directive.js"],"sourceRoot":""}