{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6******************","webpack:///webpack/bootstrap d0309a746b17cd403690?c295******************","webpack:///./lib-wm-portfolio-positions-builder-ng/model.xml","webpack:///./lib-wm-portfolio-positions-builder-ng/scripts/index.js","webpack:///./lib-wm-portfolio-positions-builder-ng/scripts/createHierarchy.js"],"names":["createHierarchy","groupListByFields","createKey","fields","item","map","field","join","list","mapKeyToList","grouped","forEach","groupKey","push","query","$leftJoin","groupedChildren","filterBy","$filterBy","concat","$idField","extended","$source","Object","assign","$field"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;ACtCA,0C;;;;;;;;;;;;;;;;;;6BCASA,e;;;;;;;;;;;;;;SCiEOC,iB,GAAAA,iB;SA0BAD,e,GAAAA,e;;;;AA3FhB;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;;;;;;;;;;;AAWO,KAAME,gCAAY,SAAZA,SAAY,CAACC,MAAD;AAAA,UAAY,UAACC,IAAD,EAAU;AAC7C,YAAOD,OAAOE,GAAP,CAAW,UAACC,KAAD;AAAA,cAAWF,KAAKE,KAAL,CAAX;AAAA,MAAX,EAAmCC,IAAnC,CAAwC,GAAxC,CAAP;AACD,IAFwB;AAAA,EAAlB;;AAIP;;;;;;;;;;;AAWO,UAASN,iBAAT,CAA2BO,IAA3B,EAAiCL,MAAjC,EAAyC;AAC9C,OAAMM,eAAeP,UAAUC,MAAV,CAArB;;AAEA,OAAMO,UAAU,EAAhB;;AAEAF,QAAKG,OAAL,CAAa,gBAAQ;AACnB,SAAMC,WAAWH,aAAaL,IAAb,CAAjB;AACA,SAAI,CAACM,QAAQE,QAAR,CAAL,EAAwB;AACtBF,eAAQE,QAAR,IAAoB,EAApB;AACD;AACDF,aAAQE,QAAR,EAAkBC,IAAlB,CAAuBT,IAAvB;AACD,IAND;;AAQA,UAAOM,OAAP;AACD;;AAED;;;;;;;;;;AAUO,UAASV,eAAT,CAAyBc,KAAzB,EAAgC;AACrC,OAAIA,MAAMC,SAAV,EAAqB;AACnB,SAAMC,kBAAkBhB,gBAAgBc,MAAMC,SAAtB,CAAxB;AACA,SAAME,WAAWH,MAAMI,SAAN,GAAkBJ,MAAMI,SAAxB,GAAoC,EAArD;AACA,SAAMT,eAAeP,UAAUe,SAASE,MAAT,CAAgBL,MAAMM,QAAtB,CAAV,CAArB;;AAEA,SAAMC,WAAWP,MAAMQ,OAAN,CAAcjB,GAAd,CAAkB;AAAA,cACjCkB,OAAOC,MAAP,CAAc,EAAd,EAAkBpB,IAAlB,sBACGU,MAAMC,SAAN,CAAgBU,MADnB,EAC4BT,gBAAgBP,aAAaL,IAAb,CAAhB,CAD5B,EADiC;AAAA,MAAlB,CAAjB;;AAMA,SAAI,CAACU,MAAMI,SAAX,EAAsB;AAAE,cAAOG,QAAP;AAAkB;AAC1C,YAAOpB,kBAAkBoB,QAAlB,EAA4BP,MAAMI,SAAlC,CAAP;AACD;AACD,UAAOjB,kBAAkBa,MAAMQ,OAAxB,EAAiCR,MAAMI,SAAvC,CAAP;AACD,E","file":"lib-wm-portfolio-positions-builder-ng/scripts/lib-wm-portfolio-positions-builder-ng.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"lib-wm-portfolio-positions-builder-ng\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"lib-wm-portfolio-positions-builder-ng\"] = factory();\n\telse\n\t\troot[\"lib-wm-portfolio-positions-builder-ng\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d0309a746b17cd403690","module.exports = require(\"./scripts/index.js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib-wm-portfolio-positions-builder-ng/model.xml\n// module id = 0\n// module chunks = 18","export { createHierarchy as default } from './createHierarchy';\n\n\n\n// WEBPACK FOOTER //\n// ./lib-wm-portfolio-positions-builder-ng/scripts/index.js","/* eslint-disable */\n\n/**\n * @util join\n *\n * @description\n * Utility for creating hierarchy of nested entities.\n *\n * @example Example of query\n * const query = {\n *   $field: 'accounts',\n *   $source: data.accounts,\n *   $idField: 'id',\n *   $leftJoin: {\n *     $field: 'assetClasses',\n *     $source: data.assetClasses,\n *     $filterBy: ['accountId'],\n *     $idField: 'id',\n *     $leftJoin: {\n *       $field: 'regions',\n *       $source: data.regions,\n *       $filterBy: ['accountId', 'assetClassId'],\n *       $idField: 'id',\n *       $leftJoin: {\n *         $field: 'countries',\n *         $source: data.countries,\n *         $filterBy: ['accountId', 'assetClassId', 'regionId'],\n *         $idField: 'id',\n *         $leftJoin: {\n *           $field: 'positions',\n *           $source: data.positions,\n *           $filterBy: ['accountId', 'assetClassId', 'regionId', 'countryId']\n *         }\n *       }\n *     }\n *   }\n * };\n */\n\n/**\n * @name createKey\n *\n * @description\n * Creates entity's unique key\n *\n * @param {array} fields List of fields to form composite key\n * @param {object} item Entity, that will be grouped\n * @type {function}\n * @returns {string} Composite key\n */\nexport const createKey = (fields) => (item) => {\n  return fields.map((field) => item[field]).join('-');\n};\n\n/**\n * @name groupListByFields\n *\n * @description\n * Groups entities by composite key\n *\n * @param {array} list List of entities to be grouped\n * @param {array} fields List of fields to form composite key\n * @type {function}\n * @returns {object} Entities grouped by fields\n */\nexport function groupListByFields(list, fields) {\n  const mapKeyToList = createKey(fields);\n\n  const grouped = {};\n\n  list.forEach(item => {\n    const groupKey = mapKeyToList(item);\n    if (!grouped[groupKey]) {\n      grouped[groupKey] = [];\n    }\n    grouped[groupKey].push(item);\n  });\n\n  return grouped;\n}\n\n/**\n * @name createHierarchy\n *\n * @description\n * Creates nested hierarchy out of connected entities\n *\n * @param {object} query Structure, that describes how to nest entities\n * @type {function}\n * @returns {array} Hierarchy of nested entities\n */\nexport function createHierarchy(query) {\n  if (query.$leftJoin) {\n    const groupedChildren = createHierarchy(query.$leftJoin);\n    const filterBy = query.$filterBy ? query.$filterBy : [];\n    const mapKeyToList = createKey(filterBy.concat(query.$idField));\n\n    const extended = query.$source.map(item => (\n      Object.assign({}, item, {\n        [query.$leftJoin.$field]: groupedChildren[mapKeyToList(item)]\n      })\n    ));\n\n    if (!query.$filterBy) { return extended; }\n    return groupListByFields(extended, query.$filterBy);\n  }\n  return groupListByFields(query.$source, query.$filterBy);\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./lib-wm-portfolio-positions-builder-ng/scripts/createHierarchy.js"],"sourceRoot":""}