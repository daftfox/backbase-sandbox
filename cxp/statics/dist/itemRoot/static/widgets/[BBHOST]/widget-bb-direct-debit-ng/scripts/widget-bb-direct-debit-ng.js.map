{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6*********","webpack:///webpack/bootstrap 22d24c31efc7cba15061?e34e*********","webpack:///./widget-bb-direct-debit-ng/model.xml","webpack:///external \"vendor-bb-angular\"?a114****","webpack:///external \"lib-bb-widget-ng\"?84ad","webpack:///external \"lib-bb-model-errors\"?7567*","webpack:///external \"lib-bb-widget-extension-ng\"?b547","webpack:///external \"lib-bb-event-bus-ng\"?8215","webpack:///external \"model-bb-payment-ng\"?f75e","webpack:///./widget-bb-direct-debit-ng/scripts/index.js","webpack:///./widget-bb-direct-debit-ng/scripts/controller.js","webpack:///./widget-bb-direct-debit-ng/scripts/constants.js","webpack:///./widget-bb-direct-debit-ng/scripts/default-hooks.js"],"names":["defaultHooks","hooksKey","run","widget","bus","publish","id","getId","module","factory","controller","name","DirectDebitController","errorMessages","DEFAULT_PAGE_SIZE","DEFAULT_MAX_NAV_PAGES","DEFAULT_PAGINATION_TYPE","DEFAULT_DISMISS_TIME","uiError","error","modelError","code","message","model","hooks","eventBus","$ctrl","preferences","getPaymentPreferences","pageSize","directDebitPageSize","maxNavPages","directDebitMaxNavPages","paginationType","directDebitPaginationType","dismissTime","notificationDismissTime","directDebits","rawItems","params","from","size","currentPage","totalItems","orderBy","defaultSortableColumn","direction","defaultSortableDirection","state","notifications","data","loading","hasMore","pageParams","status","initialLoading","loadMorePromise","hasDirectDebits","Boolean","length","replace","items","append","newItems","existingItems","getDirectDebit","find","item","load","merge","processedParams","processRequestParams","getDirectDebits","then","raw","totalCount","processDirectDebits","processedDirectDebits","catch","loadMore","done","getRequestParams","Object","assign","changePage","currentParams","reload","onSort","notifyOnRefundSuccess","res","DIRECT_DEBIT_REFUND_SUCCESS","notifyOnRefundFail","err","DIRECT_DEBIT_REFUND_FAIL","notifyOnRefuseSuccess","DIRECT_DEBIT_REFUSE_SUCCESS","notifyOnRefuseFail","DIRECT_DEBIT_REFUSE_FAIL","updateDirectDebitStatus","directDebit","refund","refundDirectDebit","refuse","refuseDirectDebit","getAvailableAction","action","directDebitAction","isDisabled","bindEvents","subscribe","NOTIFICATION_EVENT","notification","push","$onInit","ChangedStatus","PROCESSED","ANNOUNCED","Event","defaultParams"],"mappings":"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","file":"widget-bb-direct-debit-ng/scripts/widget-bb-direct-debit-ng.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vendor-bb-angular\"), require(\"lib-bb-widget-ng\"), require(\"lib-bb-model-errors\"), require(\"lib-bb-widget-extension-ng\"), require(\"lib-bb-event-bus-ng\"), require(\"model-bb-payment-ng\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"widget-bb-direct-debit-ng\", [\"vendor-bb-angular\", \"lib-bb-widget-ng\", \"lib-bb-model-errors\", \"lib-bb-widget-extension-ng\", \"lib-bb-event-bus-ng\", \"model-bb-payment-ng\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"widget-bb-direct-debit-ng\"] = factory(require(\"vendor-bb-angular\"), require(\"lib-bb-widget-ng\"), require(\"lib-bb-model-errors\"), require(\"lib-bb-widget-extension-ng\"), require(\"lib-bb-event-bus-ng\"), require(\"model-bb-payment-ng\"));\n\telse\n\t\troot[\"widget-bb-direct-debit-ng\"] = factory(root[\"vendor-bb-angular\"], root[\"lib-bb-widget-ng\"], root[\"lib-bb-model-errors\"], root[\"lib-bb-widget-extension-ng\"], root[\"lib-bb-event-bus-ng\"], root[\"model-bb-payment-ng\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_60__, __WEBPACK_EXTERNAL_MODULE_75__, __WEBPACK_EXTERNAL_MODULE_80__, __WEBPACK_EXTERNAL_MODULE_89__, __WEBPACK_EXTERNAL_MODULE_90__, __WEBPACK_EXTERNAL_MODULE_91__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 22d24c31efc7cba15061","module.exports = require(\"./scripts/index.js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./widget-bb-direct-debit-ng/model.xml\n// module id = 0\n// module chunks = 10","module.exports = __WEBPACK_EXTERNAL_MODULE_60__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"vendor-bb-angular\"\n// module id = 60\n// module chunks = 5 6 7 8 9 10 11 12 13","module.exports = __WEBPACK_EXTERNAL_MODULE_75__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-widget-ng\"\n// module id = 75\n// module chunks = 6 10 11","module.exports = __WEBPACK_EXTERNAL_MODULE_80__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-model-errors\"\n// module id = 80\n// module chunks = 6 9 10 11 12 13","module.exports = __WEBPACK_EXTERNAL_MODULE_89__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-widget-extension-ng\"\n// module id = 89\n// module chunks = 9 10 11 12 13","module.exports = __WEBPACK_EXTERNAL_MODULE_90__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-event-bus-ng\"\n// module id = 90\n// module chunks = 9 10 11 12 13","module.exports = __WEBPACK_EXTERNAL_MODULE_91__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"model-bb-payment-ng\"\n// module id = 91\n// module chunks = 9 10 11 12 13","/**\n * @module widget-bb-direct-debit-ng\n *\n * @description\n * Direct Debits Widget\n *\n * @example\n *  <div ng-controller=\"DirectDebitController as $ctrl\">\n *    <ul>\n *       <li ng-repeat=\"item in $ctrl.state.directDebits\">{{item.id}}</li>\n *    </ul>\n *  </div>\n */\nimport angular from 'vendor-bb-angular';\n\nimport extendHooks from 'lib-bb-widget-extension-ng';\nimport modelPaymentModuleKey, { modelPaymentKey } from 'model-bb-payment-ng';\nimport widgetModuleKey, { widgetKey } from 'lib-bb-widget-ng';\nimport eventBusModuleKey, { eventBusKey } from 'lib-bb-event-bus-ng';\n\nimport Controller from './controller';\nimport * as defaultHooks from './default-hooks';\n\nconst hooksKey = 'widget-bb-direct-debit-ng:hooks';\n\nfunction run(widget, bus) {\n  bus.publish('cxp.item.loaded', {\n    id: widget.getId(),\n  });\n}\n\n/**\n * @name default\n * @type {string}\n * @description Angular module name\n */\nexport default angular\n  .module('widget-bb-direct-debit-ng', [\n    modelPaymentModuleKey,\n    widgetModuleKey,\n    eventBusModuleKey,\n  ])\n  .factory(hooksKey, extendHooks(defaultHooks))\n  .controller('DirectDebitController', [\n    modelPaymentKey,\n    hooksKey,\n    widgetKey,\n    eventBusKey,\n    /* into */\n    Controller,\n  ])\n  .run([\n    widgetKey,\n    eventBusKey,\n    /* into */\n    run,\n  ])\n  .name;\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-direct-debit-ng/scripts/index.js","import { E_AUTH, E_CONNECTIVITY, E_USER, E_UNEXPECTED } from 'lib-bb-model-errors';\n\nimport { ChangedStatus, Event } from './constants';\n\nconst errorMessages = {\n  [E_AUTH]: 'directDebit.model.error.auth',\n  [E_CONNECTIVITY]: 'directDebit.model.error.connectivity',\n  [E_USER]: 'directDebit.model.error.user',\n  [E_UNEXPECTED]: 'directDebit.model.error.unexpected',\n};\n\n/**\n * Defines the default pageSize for the direct debits page\n * @type {int}\n */\nconst DEFAULT_PAGE_SIZE = 50;\n\n/**\n * Defines the default maxNavPages for the accounts page\n * as defined in the widget model.xml\n * @type {int}\n */\nconst DEFAULT_MAX_NAV_PAGES = 3;\n\n/**\n * Defines the default paginationType for the accounts page\n * as defined in the widget model.xml\n * @type {string}\n */\nconst DEFAULT_PAGINATION_TYPE = 'load-more';\n\n/**\n * Defines the default dismiss time for notification stripe\n * @type {int}\n */\nconst DEFAULT_DISMISS_TIME = 3;\n\n/**\n * @description\n * Creates an error object for template\n *\n * @name uiError\n *\n * @inner\n * @param {object} modelError Error object\n * @type {function}\n * @returns {{message: string}}\n */\nconst uiError = modelError => {\n  let error = '';\n\n  if (modelError && modelError.code) {\n    error = errorMessages[modelError.code];\n  }\n\n  return {\n    message: error,\n  };\n};\n\n/**\n * @module widget-bb-direct-debit-ng\n * @name DirectDebitController\n *\n * @description\n * Show direct debits list\n */\nexport default function DirectDebitController(model, hooks, widget, eventBus) {\n  const $ctrl = this;\n\n  const preferences = model.getPaymentPreferences();\n\n  const pageSize = preferences.directDebitPageSize || DEFAULT_PAGE_SIZE;\n  const maxNavPages = preferences.directDebitMaxNavPages || DEFAULT_MAX_NAV_PAGES;\n  const paginationType = preferences.directDebitPaginationType || DEFAULT_PAGINATION_TYPE;\n  const dismissTime = preferences.notificationDismissTime || DEFAULT_DISMISS_TIME;\n\n  const directDebits = {\n    rawItems: [],\n    params: {\n      from: 0,\n      size: pageSize,\n      currentPage: 1,\n      totalItems: 0,\n      maxNavPages,\n      paginationType,\n      orderBy: hooks.defaultSortableColumn(),\n      direction: hooks.defaultSortableDirection(),\n    },\n  };\n\n  /**\n   * @description\n   * Holds current controller state made by\n   * previous method executions\n   *\n   * @name state\n   *\n   * @type {object}\n   */\n  const state = {\n    notifications: [],\n    directDebits: {\n      data: null,\n      get orderBy() { return directDebits.params.orderBy; },\n      get direction() { return directDebits.params.direction; },\n      loading: false,\n      hasMore: false,\n    },\n    pageParams: directDebits.params,\n    status: null,\n    initialLoading: true,\n    error: null,\n  };\n\n  /**\n   * @type {Promise.<void>} loadMorePromise\n   */\n  let loadMorePromise = null;\n\n  /**\n   * @name hasDirectDebits\n   * @description\n   * if DirectDebits found returns true else false\n   *\n   * @type {function}\n   * @returns {boolean}\n   */\n  function hasDirectDebits() {\n    return Boolean(state.directDebits.data && state.directDebits.data.length);\n  }\n\n  /**\n   * Replaces existing items with new items\n   *\n   * @inner\n   * @name replace\n   * @type {function}\n   * @returns {Array} new items\n   */\n  function replace(items) {\n    return items;\n  }\n\n  /**\n   * Merges new direct debits with existing\n   *\n   * @inner\n   * @name append\n   * @type {function}\n   * @returns {Array} merged array of old and new direct debits\n   */\n  const append = (newItems, existingItems) => [...existingItems, ...newItems];\n\n  /**\n   * @description\n   * Get direct debit by ID.\n   *\n   * @name getDirectDebit\n   *\n   * @inner\n   * @type {function}\n   * @param {string} id Direct Debit ID\n   * @returns {object} A direct debit object\n   */\n  const getDirectDebit = (id) => state.directDebits.data.find(item => item.id === id);\n\n  /**\n   * @name load\n   *\n   * @description\n   * Loads direct debits data, called from $onInit\n   *\n   * @see $onInit\n   *\n   * @type {function}\n   * @param {object} params Request params\n   * @param {function} merge Function to merge loaded direct debits to the previous ones\n   * @returns {Promise.<module:model-bb-payment-ng.DirectDebits, ModelError>}\n   * Promise which is resolved once direct debits are loaded and processed,\n   * or rejected in case of errors\n   */\n  const load = (params = {}, merge = replace) => {\n    state.directDebits.loading = true;\n    const processedParams = hooks.processRequestParams(directDebits.params, params);\n\n    return model.getDirectDebits(processedParams)\n      .then(raw => {\n        directDebits.rawItems = merge(raw.data, directDebits.rawItems);\n        state.directDebits.hasMore = directDebits.rawItems.length < raw.totalCount;\n\n        state.pageParams.totalItems = raw.totalCount || 0;\n        state.pageParams.currentPage = processedParams.currentPage;\n\n        return directDebits.rawItems;\n      })\n      .then(hooks.processDirectDebits)\n      .then(processedDirectDebits => {\n        state.directDebits.data = processedDirectDebits;\n        state.directDebits.loading = false;\n      })\n      .catch(error => {\n        state.error = uiError(error);\n        state.directDebits.loading = false;\n      });\n  };\n\n  /**\n   * @name loadMore\n   *\n   * @description\n   * Loads more direct debits if they are available.\n   *\n   * @type {function}\n   * @param {function} done Callback to stop loading\n   * @returns {Promise.<module:model-bb-payment-ng.DirectDebits, ModelError>}\n   */\n  const loadMore = done => {\n    if (state.directDebits.loading) {\n      return loadMorePromise;\n    }\n\n    directDebits.params.from++;\n\n    loadMorePromise = load({}, append)\n      .then(() => {\n        loadMorePromise = null;\n        done();\n      })\n      .catch(() => {\n        loadMorePromise = null;\n        directDebits.params.from--;\n        done();\n      });\n\n    return loadMorePromise;\n  };\n\n  /**\n   * @description\n   * Get params for request.\n   *\n   * @name DirectDebitController#getRequestParams\n   *\n   * @inner\n   * @param {Object} params Custom params\n   * @type {function}\n   * @returns {Object} A request params\n   */\n  const getRequestParams = (params) => Object.assign({}, directDebits.params, {\n    // In BE services pagination starts from 0 page, but in bootstrap directive it's 1\n    from: params.currentPage - 1,\n  }, params);\n\n  /**\n   * @description\n   * Change page of displayed direct debits.\n   *\n   * @name DirectDebitController#changePage\n   * @type {function}\n   * @returns {Promise.<module:model-bb-payment-ng.DirectDebits, ModelError>}\n   * A Promise with loaded direct debits\n   */\n  const changePage = (params = {}) => {\n    const currentParams = getRequestParams(params);\n\n    return load(currentParams);\n  };\n\n  /**\n   * @name reload\n   *\n   * @description\n   * Reloads the current collection\n   *\n   * @inner\n   * @type {function}\n   * @returns {Promise.<module:model-bb-payment-ng.DirectDebits, ModelError>}\n   */\n  const reload = () => {\n    const params = directDebits.params;\n    const from = 0;\n    const size = (params.from + 1) * params.size;\n    return $ctrl.load({ from, size }, replace);\n  };\n\n  /**\n   * @name onSort\n   * @type {function}\n   * @description\n   * Loads sorted list of direct debits\n   * @param  {string} orderBy   Column key to sort\n   * @param  {string} direction Sort direction\n   */\n  const onSort = (orderBy, direction) => {\n    Object.assign(directDebits.params, {\n      orderBy,\n      direction,\n    });\n    $ctrl.reload();\n  };\n\n  /**\n   * @name notifyOnRefundSuccess\n   * @type {function}\n   * @inner\n   *\n   * @description\n   * Emit events based on refund request's success.\n   *\n   * @fires bb.event.direct.debit.refund.success\n   *\n   * @returns {object}\n   */\n  const notifyOnRefundSuccess = (res) => {\n    eventBus.publish(Event.DIRECT_DEBIT_REFUND_SUCCESS, res);\n  };\n\n  /**\n   * @name notifyOnRefundFail\n   * @type {function}\n   * @inner\n   *\n   * @description\n   * Emit events based on refund request's failure.\n   *\n   * @fires bb.event.direct.debit.refund.fail\n   *\n   * @returns {object}\n   */\n  const notifyOnRefundFail = (err) => {\n    eventBus.publish(Event.DIRECT_DEBIT_REFUND_FAIL, err);\n  };\n\n  /**\n   * @name notifyOnRefuseSuccess\n   * @type {function}\n   * @inner\n   *\n   * @description\n   * Emit events based on refuse request's success.\n   *\n   * @fires bb.event.direct.debit.refuse.success\n   *\n   * @returns {object}\n   */\n  const notifyOnRefuseSuccess = (res) => {\n    eventBus.publish(Event.DIRECT_DEBIT_REFUSE_SUCCESS, res);\n  };\n\n  /**\n   * @name notifyOnRefuseFail\n   * @type {function}\n   * @inner\n   *\n   * @description\n   * Emit events based on refuse request's failure.\n   *\n   * @fires bb.event.direct.debit.refuse.fail\n   *\n   * @returns {object}\n   */\n  const notifyOnRefuseFail = (err) => {\n    eventBus.publish(Event.DIRECT_DEBIT_REFUSE_FAIL, err);\n  };\n\n  /**\n   * @name updateDirectDebitStatus\n   * @type {function}\n   * @inner\n   *\n   * @description\n   * Update direct debit status.\n   */\n  const updateDirectDebitStatus = (item) => {\n    const directDebit = getDirectDebit(item.id);\n    if (directDebit) {\n      directDebit.status = ChangedStatus[directDebit.status];\n    }\n  };\n\n  /**\n   * @name refund\n   * @type {function}\n   * @inner\n   *\n   * @description\n   * Refund direct debit.\n   *\n   * @returns {Promise.<void, ModelError>}\n   */\n  const refund = (item) => model.refundDirectDebit(item.id)\n    .then(() => updateDirectDebitStatus(item))\n    .then(notifyOnRefundSuccess)\n    .catch(notifyOnRefundFail);\n\n  /**\n   * @name refuse\n   * @type {function}\n   * @inner\n   *\n   * @description\n   * Refund direct debit.\n   *\n   * @returns {Promise.<void, ModelError>}\n   */\n  const refuse = (item) => model.refuseDirectDebit(item.id)\n    .then(() => updateDirectDebitStatus(item))\n    .then(notifyOnRefuseSuccess)\n    .catch(notifyOnRefuseFail);\n\n  /**\n   * @name getAvailableAction\n   * @type {function}\n   * @inner\n   *\n   * @description\n   * Get action by direct debit status.\n   *\n   * @returns {function}\n   */\n  const getAvailableAction = (status) => {\n    let action;\n\n    switch (status) {\n      case 'PROCESSED':\n        action = refund;\n        break;\n      case 'ANNOUNCED':\n        action = refuse;\n        break;\n      default:\n        action = null;\n    }\n\n    return action;\n  };\n\n  /**\n   * @name directDebitAction\n   * @type {function}\n   * @inner\n   *\n   * @description\n   * Execute action over direct debit.\n   *\n   * @returns {null|Promise<void, ModelError>} Returns a Promise with action result\n   * or null if action for selected direct debit not available\n   */\n  const directDebitAction = (item) => {\n    const directDebit = getDirectDebit(item.id);\n    const action = getAvailableAction(item.status);\n\n    directDebit.isDisabled = true;\n\n    if (action) {\n      return action(item).then(() => {\n        directDebit.isDisabled = false;\n      });\n    }\n\n    return null;\n  };\n\n  /**\n   * @name bindEvents\n   *\n   * @description\n   * Adds subscriptions to bus events\n   *\n   * @inner\n   * @type {function}\n   */\n  const bindEvents = () => {\n    eventBus.subscribe(Event.NOTIFICATION_EVENT, (notification) => {\n      state.notifications.push(notification);\n    });\n  };\n\n  /**\n   * @name DirectDebitController#$onInit\n   *\n   * @description\n   * AngularJS Lifecycle hook used to initialize the controller\n   *\n   * @type {function}\n   * @returns {Promise.<module:model-bb-payment-ng.DirectDebits, ModelError>}\n   * Promise which is resolved once contoller is initialized, or rejected in case of errors\n   */\n  const $onInit = () => load()\n    .then(bindEvents)\n    .then(() => {\n      state.initialLoading = false;\n    });\n\n  Object.assign($ctrl, {\n    state,\n    dismissTime,\n    hasDirectDebits,\n    loadMore,\n    onSort,\n    load,\n    reload,\n    directDebitAction,\n    /* Lifecycle hooks */\n    $onInit,\n    changePage,\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-direct-debit-ng/scripts/controller.js","/**\n * Changed status enumeration\n * @name  ChangedStatus\n * @enum {string}\n * @type {object}\n */\nexport const ChangedStatus = {\n  PROCESSED: 'REFUND_REQUESTED',\n  ANNOUNCED: 'REFUSAL_REQUESTED',\n};\n\n/**\n * Bus events enumeration\n * @name  Event\n * @enum {string}\n * @type {object}\n */\nexport const Event = {\n  DIRECT_DEBIT_REFUND_SUCCESS: 'bb.event.direct.debit.refund.success',\n  DIRECT_DEBIT_REFUND_FAIL: 'bb.event.direct.debit.refund.fail',\n  DIRECT_DEBIT_REFUSE_SUCCESS: 'bb.event.direct.debit.refuse.success',\n  DIRECT_DEBIT_REFUSE_FAIL: 'bb.event.direct.debit.refuse.fail',\n  NOTIFICATION_EVENT: 'bb.event.notifications.notify',\n};\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-direct-debit-ng/scripts/constants.js","/**\n * @name default-hooks\n * @type {object}\n *\n * @description\n * Default hooks for widget-bb-direct-debit-ng\n */\n\n/**\n * @name default-hooks#processRequestParams\n *\n * @description\n * processRequestParams default hook\n *\n * @param {object} defaultParams\n * @param {object} params\n * @type {function}\n * @returns {object} processed request parameters\n */\nexport const processRequestParams = (defaultParams, params) =>\n  Object.assign({}, defaultParams, params);\n\n/**\n * @name default-hooks#processDirectDebits\n *\n * @description\n * processDirectDebits default hook\n *\n * @param {array<objects>} directDebits\n * @type {function}\n * @returns {array.<object>} directDebits\n */\nexport const processDirectDebits = (directDebits) => directDebits;\n\n/**\n * @name default-hooks#defaultSortableColumn\n *\n * @description\n * defaultSortableColumn default hook\n *\n * @type {function}\n * @returns {string|null}\n */\nexport const defaultSortableColumn = () => null;\n\n/**\n * @name default-hooks#defaultSortableDirection\n *\n * @description\n * defaultSortableColumn default hook\n *\n * @type {function}\n * @returns {string|null}\n */\nexport const defaultSortableDirection = () => null;\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-direct-debit-ng/scripts/default-hooks.js"],"sourceRoot":""}