{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6******************","webpack:///webpack/bootstrap 70daa42420248d0dae68?ba28******************","webpack:///./widget-bb-select-context-ng/model.xml","webpack:///external \"vendor-bb-angular\"?a114**********","webpack:///external \"lib-bb-widget-extension-ng\"?b547","webpack:///external \"lib-bb-widget-ng\"?84ad***","webpack:///./widget-bb-select-context-ng/scripts/index.js","webpack:///external \"lib-bb-user-data-ng\"","webpack:///external \"model-bb-select-context-ng\"","webpack:///./widget-bb-select-context-ng/scripts/view-model.js","webpack:///./widget-bb-select-context-ng/scripts/default-hooks.js","webpack:///./widget-bb-select-context-ng/scripts/controller.js","webpack:///./widget-bb-select-context-ng/scripts/constants.js"],"names":["defaultHooks","moduleKey","hooksKey","viewModelKey","angular","module","modelSelectContextModuleKey","widgetModuleKey","bbUserDataModuleKey","factory","ViewModel","controller","modelSelectContextKey","bbUserDataServiceKey","widgetKey","Controller","name","viewModel","append","newItems","existingItems","getServiceAgreementId","state","serviceAgreementId","getServiceAgreementName","serviceAgreementName","getLegalEntityId","legalEntityId","getLegalEntityName","legalEntityName","isServiceAgreementsShown","Boolean","showServiceAgreements","isLegalEntitiesDisabled","disableLegalEntities","setServiceAgreement","id","Object","assign","setLegalEntity","setServiceAgreementsShown","value","setLegalEntitiesDisabled","hasMoreServiceAgreements","serviceAgreements","totalItems","hasMore","rawItems","length","appendServiceAgreements","raw","data","getServiceAgreements","resetServiceAgreements","resetLegalEntity","hasMoreLegalEntities","legalEntities","appendLegalEntities","getLegalEntities","resetLegalEntities","getInitialState","setCookie","days","date","Date","setTime","getTime","document","cookie","JSON","stringify","toGMTString","getCookie","split","reduce","cookies","key","decodeURIComponent","processPortalObject","portal","console","warn","loggedInUserId","processProfileData","user","SelectContextController","contextModel","userDataService","widgetInstance","hooks","$window","$ctrl","window","b$","selectContextRedirectPage","getStringPreference","settings","SELECT_CONTEXT_REDIRECT_PAGE","logoutRedirectPage","LOGOUT_REDIRECT_PAGE","cookieTTL","REMEMBER_PREFERENCES_TTL","listSize","getLongPreference","LIST_SIZE","DEFAULT_LIST_SIZE","selectContextRedirectUrl","config","serverRoot","portalName","logoutRedirectUrl","showContextSelector","debounce","DEBOUNCE_TIME","from","sa","le","getUserFromPortal","getUserData","then","currentUser","userData","selectUserContext","loading","isSuccess","contextCookieNames","CONTEXT_NAMES","contract","company","location","Promise","reject","catch","selectContextError","options","isLoadMore","requestParams","size","query","searchQuery","resp","autoSelect","fetchError","selectServiceAgreement","selectLegalEntity","e","logout","saError","paramChar","indexOf","$onInit","defineProperty","get","REMEMBER_ME_COOKIE_NAME","USER_CONTEXT"],"mappings":"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","file":"widget-bb-select-context-ng/scripts/widget-bb-select-context-ng.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vendor-bb-angular\"), require(\"lib-bb-widget-extension-ng\"), require(\"lib-bb-widget-ng\"), require(\"lib-bb-user-data-ng\"), require(\"model-bb-select-context-ng\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"widget-bb-select-context-ng\", [\"vendor-bb-angular\", \"lib-bb-widget-extension-ng\", \"lib-bb-widget-ng\", \"lib-bb-user-data-ng\", \"model-bb-select-context-ng\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"widget-bb-select-context-ng\"] = factory(require(\"vendor-bb-angular\"), require(\"lib-bb-widget-extension-ng\"), require(\"lib-bb-widget-ng\"), require(\"lib-bb-user-data-ng\"), require(\"model-bb-select-context-ng\"));\n\telse\n\t\troot[\"widget-bb-select-context-ng\"] = factory(root[\"vendor-bb-angular\"], root[\"lib-bb-widget-extension-ng\"], root[\"lib-bb-widget-ng\"], root[\"lib-bb-user-data-ng\"], root[\"model-bb-select-context-ng\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_50__, __WEBPACK_EXTERNAL_MODULE_53__, __WEBPACK_EXTERNAL_MODULE_68__, __WEBPACK_EXTERNAL_MODULE_69__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 70daa42420248d0dae68","module.exports = require(\"./scripts/index.js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./widget-bb-select-context-ng/model.xml\n// module id = 0\n// module chunks = 19","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"vendor-bb-angular\"\n// module id = 2\n// module chunks = 0 9 10 11 12 13 14 15 16 17 18 19 21 22","module.exports = __WEBPACK_EXTERNAL_MODULE_50__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-widget-extension-ng\"\n// module id = 50\n// module chunks = 15 19 21 22","module.exports = __WEBPACK_EXTERNAL_MODULE_53__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-widget-ng\"\n// module id = 53\n// module chunks = 15 16 17 18 19 21 22","/**\n * @module widget-bb-select-context-ng\n *\n * @description\n * Select context widget\n */\nimport angular from 'vendor-bb-angular';\nimport extendHooks from 'lib-bb-widget-extension-ng';\nimport widgetModuleKey, { widgetKey } from 'lib-bb-widget-ng';\nimport bbUserDataModuleKey, { bbUserDataServiceKey } from 'lib-bb-user-data-ng';\n\nimport modelSelectContextModuleKey, { modelSelectContextKey } from 'model-bb-select-context-ng';\n\nimport ViewModel from './view-model';\nimport * as defaultHooks from './default-hooks';\n\nimport Controller from './controller';\n\nconst moduleKey = 'widget-bb-select-context-ng';\nconst hooksKey = `${moduleKey}:hooks`;\nconst viewModelKey = `${moduleKey}:viewModel`;\n\nexport default angular\n  .module('widget-bb-select-context-ng', [\n    modelSelectContextModuleKey,\n    widgetModuleKey,\n    bbUserDataModuleKey,\n  ])\n  .factory(hooksKey, extendHooks(defaultHooks))\n  .factory(viewModelKey, [ViewModel])\n  .controller('SelectContextController', [\n    // dependencies to inject\n    modelSelectContextKey,\n    bbUserDataServiceKey,\n    widgetKey,\n    viewModelKey,\n    hooksKey,\n    '$window',\n    /* into */\n    Controller,\n  ])\n  .name;\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-select-context-ng/scripts/index.js","module.exports = __WEBPACK_EXTERNAL_MODULE_68__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-user-data-ng\"\n// module id = 68\n// module chunks = 19 21 22","module.exports = __WEBPACK_EXTERNAL_MODULE_69__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"model-bb-select-context-ng\"\n// module id = 69\n// module chunks = 19 21","/**\n * @name ViewModel\n * @type {object}\n *\n * @description\n * View model for widget-bb-select-context-ng\n */\n\nexport default () => {\n  const viewModel = {};\n\n  /**\n   * @name ViewModel#append\n   * @inner\n   *\n   * @description\n   * Merges new items with existing items\n   *\n   * @type {function}\n   * @returns {array} Merged array of old and new items\n   */\n  const append = (newItems, existingItems) => [...existingItems, ...newItems];\n\n  /**\n   * @name ViewModel#getServiceAgreementId\n   * @type {function}\n   *\n   * @description\n   * Returns the Service Agreement ID\n   *\n   * @returns {string}\n   * @inner\n   */\n  const getServiceAgreementId = () => viewModel.state.serviceAgreementId;\n\n  /**\n   * @name ViewModel#serviceAgreementName\n   * @type {function}\n   *\n   * @description\n   * Returns the Service Agreement name\n   *\n   * @returns {string}\n   * @inner\n   */\n  const getServiceAgreementName = () => viewModel.state.serviceAgreementName;\n\n  /**\n   * @name ViewModel#getLegalEntityId\n   * @type {function}\n   *\n   * @description\n   * Returns the Legal Entity ID\n   *\n   * @returns {string}\n   * @inner\n   */\n  const getLegalEntityId = () => viewModel.state.legalEntityId;\n\n  /**\n   * @name ViewModel#getLegalEntityName\n   * @type {function}\n   *\n   * @description\n   * Returns the Legal Entity name\n   *\n   * @returns {string}\n   * @inner\n   */\n  const getLegalEntityName = () => viewModel.state.legalEntityName;\n\n  /**\n   * @name ViewModel#isServiceAgreementsShown\n   * @type {function}\n   *\n   * @description\n   * Checks if Service Agreements should be displayed\n   *\n   * @returns {boolean}\n   * @inner\n   */\n  const isServiceAgreementsShown = () => Boolean(viewModel.state.showServiceAgreements);\n\n  /**\n   * @name ViewModel#isLegalEntitiesDisabled\n   * @type {function}\n   *\n   * @description\n   * Checks if Legal Entities should be disabled\n   *\n   * @returns {boolean}\n   * @inner\n   */\n  const isLegalEntitiesDisabled = () => Boolean(viewModel.state.disableLegalEntities);\n\n  /**\n   * @name ViewModel#setServiceAgreementId\n   * @type {function}\n   *\n   * @description\n   * Sets the given parameter as the Service Agreement ID\n   *\n   * @param {string} id\n   * @param {string} name\n   * @inner\n   */\n  const setServiceAgreement = (id, name) =>\n    (Object.assign(viewModel.state, { serviceAgreementId: id, serviceAgreementName: name }));\n\n  /**\n   * @name ViewModel#setBeneficiaries\n   * @type {function}\n   *\n   * @description\n   * Sets the given parameter as the Legal Entity ID\n   *\n   * @param {string} id\n   * @param {string} name\n   * @inner\n   */\n  const setLegalEntity = (id, name) =>\n    (Object.assign(viewModel.state, { legalEntityId: id, legalEntityName: name }));\n\n  /**\n   * @name ViewModel#setServiceAgreementsShown\n   * @type {function}\n   *\n   * @description\n   * Defines is Service Agreements should be displayed\n   *\n   * @param {boolean} value\n   * @inner\n   */\n  const setServiceAgreementsShown =\n    value => (Object.assign(viewModel.state, { showServiceAgreements: value }));\n\n  /**\n   * @name ViewModel#setLegalEntitiesDisabled\n   * @type {function}\n   *\n   * @description\n   * Defines is Legal Entity should be disabled\n   *\n   * @param {boolean} value\n   * @inner\n   */\n  const setLegalEntitiesDisabled =\n    value => (Object.assign(viewModel.state, { disableLegalEntities: value }));\n\n  /**\n   * @name ViewModel#hasMoreServiceAgreements\n   * @type {function}\n   *\n   * @description\n   * Define if there are more Service Agreements available\n   *\n   * @param {number} totalItems Amount of all matched items\n   * @inner\n   */\n  const hasMoreServiceAgreements = totalItems => {\n    viewModel.state.serviceAgreements.totalItems = totalItems;\n\n    viewModel.state.serviceAgreements.hasMore =\n      viewModel.state.serviceAgreements.rawItems.length < totalItems;\n  };\n\n  /**\n   * @name ViewModel#appendServiceAgreements\n   * @type {function}\n   *\n   * @description\n   * Append new results to the existing ones\n   *\n   * @param {array} raw Array of new Service Agreements\n   */\n  const appendServiceAgreements = raw => {\n    viewModel.state.serviceAgreements.rawItems =\n      append(raw.data, viewModel.state.serviceAgreements.rawItems);\n    hasMoreServiceAgreements(raw.totalItems);\n\n    if (raw.totalItems > 1) {\n      setServiceAgreementsShown(true);\n    }\n  };\n\n  /**\n   * @name ViewModel#getServiceAgreements\n   * @type {function}\n   *\n   * @description\n   * Get result list and state\n   *\n   * @returns {object}\n   */\n  const getServiceAgreements = () => ({\n    data: viewModel.state.serviceAgreements.rawItems,\n    totalItems: viewModel.state.serviceAgreements.totalItems,\n    hasMore: viewModel.state.serviceAgreements.hasMore,\n  });\n\n  /**\n   * @name ViewModel#resetServiceAgreements\n   * @type {function}\n   *\n   * @description\n   * Clear Service Agreements array and reset state to initial\n   *\n   * @param {?boolean} resetLegalEntity Is selected Legal Entity should be reset\n   */\n  const resetServiceAgreements = (resetLegalEntity = false) => {\n    viewModel.state.serviceAgreements = {\n      rawItems: [],\n      totalItems: 0,\n      hasMore: false,\n    };\n\n    if (resetLegalEntity) {\n      setLegalEntitiesDisabled(true);\n      setLegalEntity();\n    }\n  };\n\n  /**\n   * @name ViewModel#hasMoreLegalEntities\n   * @type {function}\n   *\n   * @description\n   * Define if there are more Legal Entities available\n   *\n   * @param {number} totalItems Amount of all matched items\n   * @inner\n   */\n  const hasMoreLegalEntities = totalItems => {\n    viewModel.state.legalEntities.totalItems = totalItems;\n\n    viewModel.state.legalEntities.hasMore =\n      viewModel.state.legalEntities.rawItems.length < totalItems;\n  };\n\n  /**\n   * @name ViewModel#appendLegalEntities\n   * @type {function}\n   *\n   * @description\n   * Append new results to the existing ones\n   *\n   * @param {array} raw Array of new Legal Entities\n   */\n  const appendLegalEntities = raw => {\n    viewModel.state.legalEntities.rawItems =\n      append(raw.data, viewModel.state.legalEntities.rawItems);\n    hasMoreLegalEntities(raw.totalItems);\n\n    setLegalEntitiesDisabled(false);\n  };\n\n  /**\n   * @name ViewModel#getLegalEntities\n   * @type {function}\n   *\n   * @description\n   * Get result list and state\n   *\n   * @returns {object}\n   */\n  const getLegalEntities = () => ({\n    data: viewModel.state.legalEntities.rawItems,\n    totalItems: viewModel.state.legalEntities.totalItems,\n    hasMore: viewModel.state.legalEntities.hasMore,\n  });\n\n  /**\n   * @name ViewModel#resetLegalEntities\n   * @type {function}\n   *\n   * @description\n   * Clear Legal Entities array and reset state to initial\n   */\n  const resetLegalEntities = () => {\n    viewModel.state.legalEntities = {\n      rawItems: [],\n      totalItems: 0,\n      hasMore: false,\n    };\n  };\n\n  /**\n   * @description\n   * Returns the initial state of the view model.\n   *\n   * @name ViewModel#getInitialState\n   * @type {function}\n   *\n   * @returns {SelectContextView}\n   * @inner\n   */\n  const getInitialState = () => ({\n    serviceAgreements: {\n      rawItems: [],\n      hasMore: false,\n    },\n    legalEntities: {\n      rawItems: [],\n      hasMore: false,\n    },\n    serviceAgreementId: null,\n    legalEntityId: null,\n    showServiceAgreements: false,\n    disableLegalEntities: true,\n  });\n\n  Object.assign(viewModel, {\n    state: getInitialState(),\n\n    getServiceAgreementId,\n    getServiceAgreementName,\n    getLegalEntityId,\n    getLegalEntityName,\n\n    isServiceAgreementsShown,\n    isLegalEntitiesDisabled,\n\n    setServiceAgreement,\n    setLegalEntity,\n    setServiceAgreementsShown,\n    setLegalEntitiesDisabled,\n\n    appendServiceAgreements,\n    getServiceAgreements,\n\n    appendLegalEntities,\n    getLegalEntities,\n\n    resetServiceAgreements,\n    resetLegalEntities,\n  });\n\n  return viewModel;\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-select-context-ng/scripts/view-model.js","/* global document */\n\n/**\n * @name default-hooks\n * @type {object}\n *\n * @description\n * Default hooks for widget-bb-select-context-ng\n */\n\n/**\n * @name default-hooks#setCookie\n * @type {function}\n *\n * @description\n * Save cookie\n *\n * @param {string} name Cookie name\n * @param {*} value     Cookie value\n * @param {number} days Cookie TTL (days)\n */\nexport const setCookie = (name, value, days = 30) => {\n  const date = new Date();\n  date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n  document.cookie = `${name}=${JSON.stringify(value)}; expires=${date.toGMTString()}; path=/`;\n};\n\n/**\n * @name default-hooks#setCookie\n * @type {function}\n *\n * @description\n * Read context preferences from cookies\n *\n * @param {string} name Cookie name\n * @return {*}\n */\nexport const getCookie = name =>\n  document.cookie.split('; ').reduce((cookies, cookie) => {\n    const [key, value] = cookie.split('=');\n\n    return Object.assign(cookies, { [key]: decodeURIComponent(value) });\n  }, {})[name] || null;\n\n/**\n * @name default-hooks#processPortalObject\n * @type {function}\n * @deprecated\n *\n * @description\n * Processes object retrieved from portal global object\n *\n * @param {Portal} portal portal data\n * @returns {User} Processed data\n */\nexport const processPortalObject = (portal) => {\n  // eslint-disable-next-line max-len, no-console\n  console.warn('DEPRECATED - processPortalObject method will be removed in the next component major release. Use \\'processProfileData\\' method instead.');\n  return { name: portal.loggedInUserId };\n};\n\n/**\n * @name default-hooks#processProfileData\n * @type {function}\n *\n * @description\n * Processes user data retrieved from user profile endpoint\n *\n * @param {User} user User data\n * @returns {User} Processed data\n */\nexport const processProfileData = (user) => user;\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-select-context-ng/scripts/default-hooks.js","/* global window */\n\nimport settings, {\n  contextCookieNames,\n  DEFAULT_LIST_SIZE,\n  DEBOUNCE_TIME } from './constants';\n\n/**\n * @name SelectContextController\n * @type {object}\n *\n * @description\n * Select Context widget\n */\nexport default function SelectContextController(\n  contextModel,\n  userDataService,\n  widgetInstance,\n  viewModel,\n  hooks,\n  $window) {\n  const $ctrl = this;\n  const portal = window.b$ && window.b$.portal;\n\n  const selectContextRedirectPage =\n    widgetInstance.getStringPreference(settings.SELECT_CONTEXT_REDIRECT_PAGE);\n  const logoutRedirectPage =\n    widgetInstance.getStringPreference(settings.LOGOUT_REDIRECT_PAGE);\n  const cookieTTL =\n    widgetInstance.getStringPreference(settings.REMEMBER_PREFERENCES_TTL);\n  const listSize = widgetInstance.getLongPreference(settings.LIST_SIZE) || DEFAULT_LIST_SIZE;\n\n  const selectContextRedirectUrl = portal ?\n    `${portal.config.serverRoot}/${portal.portalName}/${selectContextRedirectPage}` :\n    selectContextRedirectPage;\n\n  const logoutRedirectUrl = portal ?\n    `${portal.config.serverRoot}/${portal.portalName}/${logoutRedirectPage}` :\n    logoutRedirectPage;\n\n  // Check if User Context selector should be shown\n  $ctrl.showContextSelector = false;\n  $ctrl.debounce = DEBOUNCE_TIME;\n\n  const from = {\n    sa: 0,\n    le: 0,\n  };\n\n  /**\n   * @name getUserFromPortal\n   * @type {function}\n   * @inner\n   *\n   * @description\n   * Retrieves information about currently logged in user from CX endpoint or CXP global object\n   *\n   * @returns {Promise}\n   */\n  const getUserFromPortal = () =>\n    userDataService.getUserData()\n      .then(userData => {\n        $ctrl.currentUser = hooks.processProfileData(userData);\n      });\n\n\n  /**\n   * @name SelectContextController#resetServiceAgreements\n   * @type {function}\n   *\n   * @desription\n   * Clear Service Agreement selector and reset Legal Entities list\n   *\n   * @param {?boolean} resetLegalEntity Is selected Legal Entity should be reset\n   */\n  const resetServiceAgreements = (resetLegalEntity = false) => {\n    viewModel.resetServiceAgreements(resetLegalEntity);\n    from.sa = 0;\n  };\n\n  /**\n   * @name SelectContextController#resetLegalEntities\n   * @type {function}\n   *\n   * @inner\n   *\n   * @desription\n   * Clear Legal Entities selector\n   */\n  const resetLegalEntities = () => {\n    viewModel.resetLegalEntities();\n    from.le = 0;\n  };\n\n  /**\n   * @name  SelectContextController#selectUserContext\n   * @type {function}\n   *\n   * @description\n   * Select user context by Service Agreemenet and Legal Entity IDs combination\n   *\n   * @param {string} serviceAgreementId\n   * @param {string} legalEntityId\n   * @return {Promise}\n   */\n  const selectUserContext = (serviceAgreementId, legalEntityId) => {\n    $ctrl.loading = true;\n    return contextModel.selectUserContext(serviceAgreementId, legalEntityId)\n      .then(isSuccess => {\n        $ctrl.loading = false;\n        if (isSuccess) {\n          // TODO: Enable \"Remember me\" functionality when service is ready\n          // if ($ctrl.savePreferences) {\n          //   hooks.setCookie(contextCookieNames.REMEMBER_ME_COOKIE_NAME, true, cookieTTL);\n          // } else {\n          //   hooks.setCookie(contextCookieNames.REMEMBER_ME_COOKIE_NAME, false, 0);\n          // }\n\n          hooks.setCookie(\n            contextCookieNames.CONTEXT_NAMES,\n            { contract: viewModel.getServiceAgreementName(),\n              company: viewModel.getLegalEntityName() },\n            cookieTTL);\n\n          $window.location.assign(selectContextRedirectUrl);\n        } else {\n          return Promise.reject('Failed while creating a User Context');\n        }\n\n        return isSuccess;\n      }).catch(() => {\n        $ctrl.loading = false;\n        $ctrl.selectContextError = true;\n      });\n  };\n\n  /**\n   * @name SelectContextController#getLegalEntities\n   * @type {function}\n   *\n   * @description\n   * Request Legal Entities list by Service Agreement ID and searched name\n   *\n   * @param {string} id                                   Service Agreement ID\n   * @param  {object} options                             Params to send to the request\n   * @returns {Promise.<ServiceAgreements, ModelError>}   A Promise\n   */\n  const getLegalEntities = (id, options = {}) => {\n    if (!options.isLoadMore) {\n      resetLegalEntities();\n    }\n\n    const requestParams = { from: from.le, size: listSize, query: options.searchQuery };\n    return contextModel.getLegalEntities(viewModel.getServiceAgreementId(), requestParams)\n      .then(resp => {\n        $ctrl.loading = false;\n        viewModel.appendLegalEntities(resp);\n\n        if (resp.totalItems === 1 && !options.searchQuery) {\n          viewModel.setLegalEntity(resp.data[0].id, resp.data[0].name);\n          // There are single available Service Agreement and Legal Entity options\n          if (viewModel.getServiceAgreementId() && options.autoSelect) {\n            selectUserContext(viewModel.getServiceAgreementId(), viewModel.getLegalEntityId());\n          }\n        } else {\n          $ctrl.showContextSelector = true;\n        }\n\n        from.le++;\n        return viewModel.getLegalEntities();\n      }).catch(() => {\n        from.le--;\n        $ctrl.loading = false;\n        $ctrl.fetchError = true;\n      });\n  };\n\n  /**\n   * @name  SelectContextController#selectServiceAgreement\n   * @type {function}\n   *\n   * @description\n   * Define Service Agreement ID and request Legal Entities list for it\n   *\n   * @param {object} model        Service Agreement item\n   * @param {boolean} autoSelect  Select user context automatically\n   */\n  const selectServiceAgreement = ({ id, name }, autoSelect = false) => {\n    from.le = 0;\n    viewModel.setServiceAgreement(id, name);\n    return getLegalEntities(id, { autoSelect });\n  };\n\n  /**\n   * @name  SelectContextController#selectLegalEntity\n   * @type {function}\n   *\n   * @description\n   * Define Legal Entity ID\n   *\n   * @param {object} model Legal Entity item\n   */\n  const selectLegalEntity = ({ id, name }) => {\n    viewModel.setLegalEntity(id, name);\n  };\n\n  /**\n   * @name SelectContextController#getServiceAgreements\n   * @type {function}\n   *\n   * @description\n   * Request Service Agreements list by searched name\n   *\n   * @param  {object} options                             Params to send to the request\n   * @returns {Promise.<ServiceAgreements, ModelError>}   A Promise\n   */\n  const getServiceAgreements = (options = {}) => {\n    if (!options.isLoadMore) {\n      resetServiceAgreements();\n    }\n\n    const requestParams = { from: from.sa, size: listSize, query: options.searchQuery };\n    return contextModel.getServiceAgreements(requestParams)\n      .then(resp => {\n        $ctrl.loading = false;\n        viewModel.appendServiceAgreements(resp);\n\n        from.sa++;\n        return viewModel.getServiceAgreements();\n      })\n      .catch((e) => {\n        from.le--;\n        $ctrl.loading = false;\n        $ctrl.fetchError = true;\n        throw e;\n      });\n  };\n\n  /**\n   * @name  SelectContextController#logout\n   * @type {function}\n   *\n   * @description\n   * Log user out and redirect to the login page\n   */\n  const logout = (options) => {\n    contextModel.logout()\n      .then(() => {\n        if (options && options.saError) {\n          const paramChar = logoutRedirectUrl.indexOf('?') === -1 ? '?' : '&';\n          $window.location.assign(`${logoutRedirectUrl}${paramChar}sa-error`);\n        } else {\n          $window.location.assign(logoutRedirectUrl);\n        }\n      });\n  };\n\n  // TODO: Enable \"Remember me\" functionality when service is ready\n  // const isUserContextRemembered = () => {\n  //   try {\n  //     return hooks.getCookie(contextCookieNames.USER_CONTEXT) &&\n  //     JSON.parse(hooks.getCookie(contextCookieNames.REMEMBER_ME_COOKIE_NAME)) === true;\n  //   } catch (error) {\n  //     return false;\n  //   }\n  // };\n\n  /**\n   * @description\n   * AngularJS Lifecycle hook used to initialize the controller\n   * @type {function}\n   *\n   * @name SelectContextController#$onInit\n   * @return {*}\n   */\n  const $onInit = () => {\n    $ctrl.loading = true;\n    // TODO: Enable \"Remember me\" functionality when service is ready\n    // if (isUserContextRemembered()) {\n    //   return Promise.resolve($window.location.assign(selectContextRedirectUrl));\n    // }\n    getUserFromPortal();\n    return getServiceAgreements()\n      .then(resp => {\n        if (resp.totalItems === 1) {\n          selectServiceAgreement(resp.data[0], true);\n        } else {\n          $ctrl.showContextSelector = true;\n        }\n      })\n      .catch(() => {\n        logout({ saError: true });\n      });\n  };\n\n  Object.defineProperty($ctrl, 'state', {\n    get() {\n      return viewModel.state;\n    },\n  });\n\n  Object.assign($ctrl, {\n    getServiceAgreements,\n    getLegalEntities,\n    selectServiceAgreement,\n    selectLegalEntity,\n    selectUserContext,\n    resetServiceAgreements,\n    logout,\n    $onInit,\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-select-context-ng/scripts/controller.js","/**\n * Context selection page redirection keys\n * @type {Object}\n */\nexport default {\n  SELECT_CONTEXT_REDIRECT_PAGE: 'selectContextRedirectPage',\n  LOGOUT_REDIRECT_PAGE: 'logoutRedirectPage',\n  REMEMBER_PREFERENCES_TTL: 'rememberPreferencesTTL',\n  LIST_SIZE: 'listSize',\n};\n\n/**\n * User context cookie names\n * @type {{REMEMBER_ME_COOKIE_NAME: string, USER_CONTEXT: string, CONTEXT_NAMES: string}}\n */\nexport const contextCookieNames = {\n  REMEMBER_ME_COOKIE_NAME: 'REMEMBER_USER_CONTEXT',\n  USER_CONTEXT: 'USER_CONTEXT',\n  CONTEXT_NAMES: 'context-names',\n};\n\n/**\n * Amount of items on autocomplete scroll\n * @type {number}\n */\nexport const DEFAULT_LIST_SIZE = 7;\n\n\n/**\n * Debounce time on autocomplete\n * @type {number}\n */\nexport const DEBOUNCE_TIME = 300;\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-select-context-ng/scripts/constants.js"],"sourceRoot":""}