{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6*********************","webpack:///webpack/bootstrap 70daa42420248d0dae68?ba28*********************","webpack:///./widget-bb-user-menu-ng/model.xml","webpack:///external \"vendor-bb-angular\"?a114************","webpack:///external \"lib-bb-widget-extension-ng\"?b547**","webpack:///external \"lib-bb-intent-ng\"?add1***","webpack:///external \"lib-bb-widget-ng\"?84ad*****","webpack:///external \"lib-bb-storage-ng\"?d742*","webpack:///external \"lib-bb-login-logout-notifier-ng\"?980d","webpack:///external \"model-bb-login-ng\"?ff84*","webpack:///external \"lib-bb-user-data-ng\"?1b2b*","webpack:///./widget-bb-user-menu-ng/scripts/index.js","webpack:///./widget-bb-user-menu-ng/scripts/controller.js","webpack:///./widget-bb-user-menu-ng/scripts/constants.js","webpack:///./widget-bb-user-menu-ng/scripts/default-hooks.js"],"names":["moduleKey","hooksKey","angular","module","widgetModuleKey","modelLoginModuleKey","bbIntentModuleKey","bbUserDataModuleKey","bbLoginLogoutNotifierModuleKey","bbStorageModuleKey","factory","defaultHooks","controller","modelLoginKey","bbUserDataServiceKey","widgetKey","bbLoginLogoutNotifierServiceKey","bbStorageServiceKey","Controller","run","bbIntentKey","bbIntent","init","name","UserMenuController","hooks","model","userDataService","widgetInstance","loginLogoutNotifier","bbStorage","$window","$ctrl","logoutRedirectPage","getStringPreference","userDataUrl","cx5Portal","b$","portal","cx6Portal","_portalConfiguration","urlRoot","config","serverRoot","linkRoot","logoutRedirectUrl","portalName","unsubscribeFromUserLogout","logout","then","removeItem","BbStorageKeys","PRODUCT_SUMMARY","PRODUCT_SELECTED","PRODUCTS_SELECTED","CONTACT_SELECTED","setUserLoggedOut","location","assign","loggedUser","console","warn","currentUser","getUserFromPortal","getUserData","processProfileData","userData","$onInit","subscribeToUserLogout","$onDestroy","Object","user"],"mappings":"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","file":"widget-bb-user-menu-ng/scripts/widget-bb-user-menu-ng.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vendor-bb-angular\"), require(\"lib-bb-widget-extension-ng\"), require(\"lib-bb-intent-ng\"), require(\"lib-bb-widget-ng\"), require(\"lib-bb-storage-ng\"), require(\"lib-bb-login-logout-notifier-ng\"), require(\"model-bb-login-ng\"), require(\"lib-bb-user-data-ng\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"widget-bb-user-menu-ng\", [\"vendor-bb-angular\", \"lib-bb-widget-extension-ng\", \"lib-bb-intent-ng\", \"lib-bb-widget-ng\", \"lib-bb-storage-ng\", \"lib-bb-login-logout-notifier-ng\", \"model-bb-login-ng\", \"lib-bb-user-data-ng\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"widget-bb-user-menu-ng\"] = factory(require(\"vendor-bb-angular\"), require(\"lib-bb-widget-extension-ng\"), require(\"lib-bb-intent-ng\"), require(\"lib-bb-widget-ng\"), require(\"lib-bb-storage-ng\"), require(\"lib-bb-login-logout-notifier-ng\"), require(\"model-bb-login-ng\"), require(\"lib-bb-user-data-ng\"));\n\telse\n\t\troot[\"widget-bb-user-menu-ng\"] = factory(root[\"vendor-bb-angular\"], root[\"lib-bb-widget-extension-ng\"], root[\"lib-bb-intent-ng\"], root[\"lib-bb-widget-ng\"], root[\"lib-bb-storage-ng\"], root[\"lib-bb-login-logout-notifier-ng\"], root[\"model-bb-login-ng\"], root[\"lib-bb-user-data-ng\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_50__, __WEBPACK_EXTERNAL_MODULE_51__, __WEBPACK_EXTERNAL_MODULE_53__, __WEBPACK_EXTERNAL_MODULE_62__, __WEBPACK_EXTERNAL_MODULE_63__, __WEBPACK_EXTERNAL_MODULE_64__, __WEBPACK_EXTERNAL_MODULE_68__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 70daa42420248d0dae68","module.exports = require(\"./scripts/index.js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./widget-bb-user-menu-ng/model.xml\n// module id = 0\n// module chunks = 22","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"vendor-bb-angular\"\n// module id = 2\n// module chunks = 0 9 10 11 12 13 14 15 16 17 18 19 21 22","module.exports = __WEBPACK_EXTERNAL_MODULE_50__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-widget-extension-ng\"\n// module id = 50\n// module chunks = 15 19 21 22","module.exports = __WEBPACK_EXTERNAL_MODULE_51__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-intent-ng\"\n// module id = 51\n// module chunks = 15 16 18 21 22","module.exports = __WEBPACK_EXTERNAL_MODULE_53__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-widget-ng\"\n// module id = 53\n// module chunks = 15 16 17 18 19 21 22","module.exports = __WEBPACK_EXTERNAL_MODULE_62__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-storage-ng\"\n// module id = 62\n// module chunks = 18 21 22","module.exports = __WEBPACK_EXTERNAL_MODULE_63__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-login-logout-notifier-ng\"\n// module id = 63\n// module chunks = 18 22","module.exports = __WEBPACK_EXTERNAL_MODULE_64__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"model-bb-login-ng\"\n// module id = 64\n// module chunks = 18 21 22","module.exports = __WEBPACK_EXTERNAL_MODULE_68__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-user-data-ng\"\n// module id = 68\n// module chunks = 19 21 22","/**\n * @module widget-bb-user-menu-ng\n *\n * @description\n * User Menu widget\n */\nimport angular from 'vendor-bb-angular';\n\nimport widgetModuleKey, { widgetKey } from 'lib-bb-widget-ng';\nimport bbIntentModuleKey, { bbIntentKey } from 'lib-bb-intent-ng';\nimport bbUserDataModuleKey, { bbUserDataServiceKey } from 'lib-bb-user-data-ng';\nimport modelLoginModuleKey, { modelLoginKey } from 'model-bb-login-ng';\nimport bbLoginLogoutNotifierModuleKey,\n  { bbLoginLogoutNotifierServiceKey } from 'lib-bb-login-logout-notifier-ng';\nimport extendHooks from 'lib-bb-widget-extension-ng';\nimport bbStorageModuleKey, { bbStorageServiceKey } from 'lib-bb-storage-ng';\n\nimport Controller from './controller';\nimport defaultHooks from './default-hooks';\n\nconst moduleKey = 'widget-bb-user-menu-ng';\nconst hooksKey = `${moduleKey}:hooks`;\n\nexport default angular\n  .module(moduleKey, [\n    widgetModuleKey,\n    modelLoginModuleKey,\n    bbIntentModuleKey,\n    bbUserDataModuleKey,\n    bbLoginLogoutNotifierModuleKey,\n    bbStorageModuleKey,\n  ])\n\n  .factory(hooksKey, extendHooks(defaultHooks))\n\n  .controller('UserMenuController', [\n    // dependencies to inject\n    hooksKey,\n    modelLoginKey,\n    bbUserDataServiceKey,\n    widgetKey,\n    bbLoginLogoutNotifierServiceKey,\n    bbStorageServiceKey,\n    '$window',\n    /* into */\n    Controller,\n  ])\n\n  .run([bbIntentKey, (bbIntent) => {\n    bbIntent.init();\n  }])\n\n  .name;\n\n/**\n * @typedef {object} User\n * @property {string} name Name that should be displayed on page\n * @property {?string} username Internal user identifier\n */\n\n/**\n * @typedef {object} Portal\n * @property {string} loggedInUserId Internally used unique identification of the user\n */\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-user-menu-ng/scripts/index.js","import { BbStorageKeys } from './constants';\n\n/* global window */\n/* eslint no-underscore-dangle: [\"error\", { \"allow\": [\"_portalConfiguration\"] }] */\n/**\n * @name UserMenuController\n * @type {object}\n *\n * @description\n * User Menu widget\n */\nexport default function UserMenuController(\n  hooks,\n  model,\n  userDataService,\n  widgetInstance,\n  loginLogoutNotifier,\n  bbStorage,\n  $window) {\n  const $ctrl = this;\n\n  const logoutRedirectPage = widgetInstance.getStringPreference('logoutRedirectPage');\n  const userDataUrl = widgetInstance.getStringPreference('userDataUrl');\n\n  const cx5Portal = $window.b$ && $window.b$.portal;\n  const cx6Portal = $window._portalConfiguration;\n\n  const urlRoot = cx5Portal ? cx5Portal.config.serverRoot : cx6Portal.linkRoot;\n  const logoutRedirectUrl = (cx5Portal || cx6Portal) ?\n    `${urlRoot}/${(cx5Portal || cx6Portal).portalName}/${logoutRedirectPage}` :\n    logoutRedirectPage;\n\n  let unsubscribeFromUserLogout = () => {};\n\n  const logout = () => (\n    model.logout()\n      .then(() => {\n        bbStorage.removeItem(BbStorageKeys.PRODUCT_SUMMARY);\n        bbStorage.removeItem(BbStorageKeys.PRODUCT_SELECTED);\n        bbStorage.removeItem(BbStorageKeys.PRODUCTS_SELECTED);\n        bbStorage.removeItem(BbStorageKeys.CONTACT_SELECTED);\n      })\n      .then(() => {\n        loginLogoutNotifier.setUserLoggedOut();\n        $window.location.assign(logoutRedirectUrl);\n      })\n  );\n\n  const loggedUser = () => {\n    // eslint-disable-next-line max-len, no-console\n    console.warn('DEPRECATED - loggedUser method will be removed in the next component major release. Use \\'currentUser\\' object instead.');\n    return $ctrl.currentUser.name || '';\n  };\n\n  /**\n   * @name getUserFromPortal\n   * @type {function}\n   * @inner\n   *\n   * @description\n   * Retrieves information about currently logged in user from CX endpoint or CXP global object\n   *\n   * @returns {Promise}\n   */\n  const getUserFromPortal = () =>\n    userDataService.getUserData()\n      .then(userData => {\n        $ctrl.currentUser = hooks.processProfileData(userData);\n      });\n\n  const $onInit = () => {\n    unsubscribeFromUserLogout = loginLogoutNotifier.subscribeToUserLogout(() => {\n      $window.location.assign(logoutRedirectUrl);\n    });\n\n    return getUserFromPortal();\n  };\n\n  const $onDestroy = () => {\n    unsubscribeFromUserLogout();\n  };\n\n\n  Object.assign($ctrl, {\n    /**\n     * @description AngularJS Lifecycle hook used to initialize the controller\n     * @type {function}\n     *\n     * @name UserMenuController#$onInit\n     * @returns {Promise.<void>}\n     */\n    $onInit,\n    /**\n     * @description AngularJS Lifecycle hook used to destroy the controller\n     * @type {function}\n     *\n     * @name UserMenuController#$onDestroy\n     * @returns {Promise.<void>}\n     */\n    $onDestroy,\n    /**\n     * @description Logout function\n     * @type {function}\n     *\n     * @name UserMenuController#logout\n     * @returns {Promise}\n     */\n    logout,\n    /**\n     * @description Currently logged in user's data object\n     * @name UserMenuController#currentUser\n     * @type {User}\n     */\n    currentUser: {},\n    /**\n     * @description Retrieves logged in user id\n     * Returns empty string if user is not found (deprecated)\n     * @type {function}\n     *\n     * @name UserMenuController#loggedUser\n     * @returns {string}\n     */\n    loggedUser,\n    /**\n     * @description URL that leads to the page with additional user data\n     * @name UserMenuController#userDataUrl\n     * @type {string}\n     */\n    userDataUrl,\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-user-menu-ng/scripts/controller.js","/* eslint-disable import/prefer-default-export */\n\n/**\n * @name BbStorageKeys\n *\n * @description\n * bbStorage keys enum.\n *\n * @type {object}\n */\nexport const BbStorageKeys = {\n  PRODUCT_SUMMARY: 'bb.product.summary.data',\n  PRODUCT_SELECTED: 'bb.product.selected',\n  PRODUCTS_SELECTED: 'bb.event.products.selected',\n  CONTACT_SELECTED: 'bb.contact.selected',\n};\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-user-menu-ng/scripts/constants.js","/**\n * @name default-hooks\n * @type {object}\n *\n * @description\n * Default hooks for widget-bb-user-menu-ng\n */\n\n/**\n * @name default-hooks#processProfileData\n * @type {function}\n *\n * @description\n * Processes user data retrieved from user profile endpoint\n *\n * @param {User} user User data\n * @returns {User} Processed data\n */\nconst processProfileData = (user) => user;\n\nexport default {\n  processProfileData,\n};\n\n\n\n// WEBPACK FOOTER //\n// ./widget-bb-user-menu-ng/scripts/default-hooks.js"],"sourceRoot":""}