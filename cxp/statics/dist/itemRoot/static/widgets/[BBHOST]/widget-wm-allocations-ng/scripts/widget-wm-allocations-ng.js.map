{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6****************************","webpack:///webpack/bootstrap d0309a746b17cd403690?c295****************************","webpack:///./widget-wm-allocations-ng/model.xml","webpack:///external \"lib-bb-state-container-ng\"?8d56**","webpack:///external \"lib-wm-portfolio-view-model-helper\"?8f7a**","webpack:///external \"vendor-bb-angular\"","webpack:///external \"lib-bb-widget-extension-ng\"?b547","webpack:///external \"model-wm-portfolio-summary-ng\"?e4f4","webpack:///external \"lib-wm-portfolio-router-ng\"?a72f","webpack:///./widget-wm-allocations-ng/scripts/index.js","webpack:///./widget-wm-allocations-ng/scripts/controller.js","webpack:///./widget-wm-allocations-ng/scripts/view-model.js","webpack:///./widget-wm-allocations-ng/scripts/service.js"],"names":["viewModelKey","allocationsServiceKey","angular","module","modelPortfolioSummaryModuleKey","stateContainerModuleKey","routerModuleKey","factory","bbStateContainerKey","ViewModel","modelPortfolioSummaryKey","AllocationsService","extensionContextKey","allocationsService","controller","routerKey","Controller","run","viewModel","init","name","AllocationsController","CURRENCIES_ROUTE","ASSET_CLASSES_ROUTE","router","$ctrl","unsubscribe","switchAllocations","getRoute","goto","load","currentRoute","loadCurrencies","loadAssetClasses","$onInit","subscribe","$onDestroy","Object","assign","state","getState","errors","initialState","allocations","data","additions","loading","allocationsError","route","params","initialLoading","stateContainer","beforeLoadAssetClasses","afterLoadAssetClassesSuccess","raw","afterLoadAssetClassesError","error","code","beforeLoadCurrencies","afterLoadCurrenciesSuccess","afterLoadCurrenciesError","model","getSelectedPortfolioId","then","loadAllocationClasses","catch","loadAllocationCurrencies"],"mappings":"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","file":"widget-wm-allocations-ng/scripts/widget-wm-allocations-ng.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lib-bb-state-container-ng\"), require(\"lib-wm-portfolio-view-model-helper\"), require(\"vendor-bb-angular\"), require(\"lib-bb-widget-extension-ng\"), require(\"model-wm-portfolio-summary-ng\"), require(\"lib-wm-portfolio-router-ng\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"widget-wm-allocations-ng\", [\"lib-bb-state-container-ng\", \"lib-wm-portfolio-view-model-helper\", \"vendor-bb-angular\", \"lib-bb-widget-extension-ng\", \"model-wm-portfolio-summary-ng\", \"lib-wm-portfolio-router-ng\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"widget-wm-allocations-ng\"] = factory(require(\"lib-bb-state-container-ng\"), require(\"lib-wm-portfolio-view-model-helper\"), require(\"vendor-bb-angular\"), require(\"lib-bb-widget-extension-ng\"), require(\"model-wm-portfolio-summary-ng\"), require(\"lib-wm-portfolio-router-ng\"));\n\telse\n\t\troot[\"widget-wm-allocations-ng\"] = factory(root[\"lib-bb-state-container-ng\"], root[\"lib-wm-portfolio-view-model-helper\"], root[\"vendor-bb-angular\"], root[\"lib-bb-widget-extension-ng\"], root[\"model-wm-portfolio-summary-ng\"], root[\"lib-wm-portfolio-router-ng\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_86__, __WEBPACK_EXTERNAL_MODULE_88__, __WEBPACK_EXTERNAL_MODULE_93__, __WEBPACK_EXTERNAL_MODULE_125__, __WEBPACK_EXTERNAL_MODULE_126__, __WEBPACK_EXTERNAL_MODULE_128__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d0309a746b17cd403690","module.exports = require(\"./scripts/index.js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./widget-wm-allocations-ng/model.xml\n// module id = 0\n// module chunks = 29","module.exports = __WEBPACK_EXTERNAL_MODULE_86__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-state-container-ng\"\n// module id = 86\n// module chunks = 19 28 29 30 31 32 33 34 35 36 37","module.exports = __WEBPACK_EXTERNAL_MODULE_88__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-wm-portfolio-view-model-helper\"\n// module id = 88\n// module chunks = 19 28 29 30 31 32 33 34 35 36 37","module.exports = __WEBPACK_EXTERNAL_MODULE_93__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"vendor-bb-angular\"\n// module id = 93\n// module chunks = 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37","module.exports = __WEBPACK_EXTERNAL_MODULE_125__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-widget-extension-ng\"\n// module id = 125\n// module chunks = 28 29 30 31 32 33 34 35 36","module.exports = __WEBPACK_EXTERNAL_MODULE_126__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"model-wm-portfolio-summary-ng\"\n// module id = 126\n// module chunks = 28 29 30 31 32 33 34 35 36 37","module.exports = __WEBPACK_EXTERNAL_MODULE_128__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-wm-portfolio-router-ng\"\n// module id = 128\n// module chunks = 28 29 37","/**\n * @module widget-wm-allocations-ng\n *\n * @description\n * Allocations widget.\n *\n *\n * @example\n *  <div ng-controller=\"AllocationsController as $ctrl\">\n *    <ul>\n *       <li ng-repeat=\"allocation in $ctrl.allocations\">{{allocation.id}}</li>\n *    </ul>\n *  </div>\n */\nimport angular from 'vendor-bb-angular';\nimport { extensionContextKey } from 'lib-bb-widget-extension-ng';\nimport modelPortfolioSummaryModuleKey, {\n  modelPortfolioSummaryKey,\n}\n  from 'model-wm-portfolio-summary-ng';\nimport routerModuleKey, { routerKey } from 'lib-wm-portfolio-router-ng';\nimport stateContainerModuleKey, { bbStateContainerKey } from 'lib-bb-state-container-ng';\nimport Controller from './controller';\nimport ViewModel from './view-model';\nimport AllocationsService from './service';\n\n\nconst viewModelKey = 'viewModel';\nconst allocationsServiceKey = 'allocationsService';\n\n/**\n * @name default\n * @type {string}\n * @description Angular module name\n */\nexport default angular\n  .module('widget-wm-allocations-ng', [\n    modelPortfolioSummaryModuleKey,\n    stateContainerModuleKey,\n    routerModuleKey,\n  ])\n\n  .factory(viewModelKey, [bbStateContainerKey, ViewModel])\n  .factory(allocationsServiceKey, [modelPortfolioSummaryKey, viewModelKey, AllocationsService])\n  .factory(extensionContextKey, [\n    allocationsServiceKey,\n    allocationsService => ({ allocationsService }),\n  ])\n\n  .controller('AllocationsController', [\n    viewModelKey,\n    allocationsServiceKey,\n    routerKey,\n    /* into */\n    Controller,\n  ])\n\n  .run([viewModelKey, viewModel => {\n    viewModel.init();\n  }])\n  .name;\n\n\n\n// WEBPACK FOOTER //\n// ./widget-wm-allocations-ng/scripts/index.js","export const CURRENCIES_ROUTE = 'currencies';\nexport const ASSET_CLASSES_ROUTE = 'asset-classes';\n\n/**\n * @name AllocationsController\n * @ngkey AllocationsController\n * @type {object}\n * @description\n * Allocations controller.\n */\nexport default function AllocationsController(\n  viewModel,\n  allocationsService,\n  router\n) {\n  const $ctrl = this;\n  let unsubscribe;\n\n  /**\n   * @description\n   * Redirects widget depending on current route\n   *\n   * @public\n   * @name AllocationsController#switchAllocations\n   * @type {function}\n   */\n  const switchAllocations = () => {\n    if (router.getRoute() !== CURRENCIES_ROUTE) {\n      router.goto(CURRENCIES_ROUTE);\n    } else {\n      router.goto(ASSET_CLASSES_ROUTE);\n    }\n  };\n\n  /**\n   * @description\n   * Loads allocations currencies data or allocations asset classes\n   *  data depending on current application route\n   *\n   * @public\n   * @name AllocationsController#load\n   * @type {function}\n   * @returns {promise.<array.<Allocation>>}\n   */\n  const load = (currentRoute) => {\n    switch (currentRoute) {\n      case CURRENCIES_ROUTE:\n        return allocationsService.loadCurrencies();\n      default:\n        return allocationsService.loadAssetClasses();\n    }\n  };\n\n  /*\n   * @description\n   * Widget initialization logic.\n   * Subscribes to changing of the route.\n   * Invokes initial loading of data\n   */\n  const $onInit = () => {\n    unsubscribe = router.subscribe((currentRoute) => {\n      load(currentRoute);\n    });\n\n    return load();\n  };\n\n  const $onDestroy = () => unsubscribe();\n\n  Object.assign($ctrl, {\n    load,\n    switchAllocations,\n    $onInit,\n    $onDestroy,\n  });\n\n  return Object.assign(\n    {\n      get state() {\n        return viewModel.getState();\n      },\n      get errors() {\n        return viewModel.getState().errors;\n      },\n    },\n    $ctrl\n  );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./widget-wm-allocations-ng/scripts/controller.js","import { wrapActions } from 'lib-wm-portfolio-view-model-helper';\n\n/**\n * @name initialState\n * @description Initial state of widgets store\n * @type {object}\n * @property {Object} allocations Allocations data\n * @property {errors} errors Errors model\n * @property {boolean} initialLoading Boolean flag of initial loading\n * @property {object} route Router model\n */\nconst initialState = {\n  allocations: {\n    data: {\n      allocations: [],\n      additions: {},\n    },\n    loading: false,\n  },\n  errors: {\n    allocationsError: null,\n  },\n  route: {\n    name: 'asset-classes',\n    params: {},\n  },\n  initialLoading: true,\n};\n\nexport default (stateContainer) => ({\n  getState: stateContainer.getState,\n  ...wrapActions(stateContainer, {\n    init: (state = initialState) => state,\n    beforeLoadAssetClasses: () => ({\n      allocations: {\n        loading: true,\n      },\n    }),\n    afterLoadAssetClassesSuccess: (state, raw) => ({\n      initialLoading: false,\n      allocations: {\n        loading: false,\n        data: raw.data,\n      },\n      errors: {\n        allocationsError: null,\n      },\n    }),\n    afterLoadAssetClassesError: (state, error) => ({\n      initialLoading: false,\n      allocations: {\n        loading: false,\n        data: [],\n      },\n      errors: {\n        allocationsError: error.code,\n      },\n    }),\n    beforeLoadCurrencies: () => ({\n      allocations: {\n        loading: true,\n      },\n    }),\n    afterLoadCurrenciesSuccess: (state, raw) => ({\n      initialLoading: false,\n      allocations: {\n        loading: false,\n        data: raw.data,\n      },\n      errors: {\n        allocationsError: null,\n      },\n    }),\n    afterLoadCurrenciesError: (state, error) => ({\n      initialLoading: false,\n      allocations: {\n        loading: false,\n        data: [],\n      },\n      errors: {\n        allocationsError: error.code,\n      },\n    }),\n  }),\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./widget-wm-allocations-ng/scripts/view-model.js","export default (model, viewModel) => ({\n  /**\n   * @description\n   * Initial state of porfolio details store\n   *\n   * @public\n   * @name AllocationsController#loadAssetClasses\n   * @type {function}\n   * Load allocations\n   * @returns {promise.<array>}\n   */\n  loadAssetClasses: () => {\n    viewModel.beforeLoadAssetClasses();\n\n    return model.getSelectedPortfolioId()\n      .then(model.loadAllocationClasses)\n      .then(viewModel.afterLoadAssetClassesSuccess)\n      .catch(viewModel.afterLoadAssetClassesError);\n  },\n\n  /**\n   * @description\n   * Handles loading allocations currencies data\n   *\n   * @public\n   * @name AllocationsController#loadCurrencies\n   * @type {function}\n   * Load allocations\n   * @returns {promise.<array>}\n   */\n  loadCurrencies: () => {\n    viewModel.beforeLoadCurrencies();\n\n    return model.getSelectedPortfolioId()\n      .then(model.loadAllocationCurrencies)\n      .then(viewModel.afterLoadCurrenciesSuccess)\n      .catch(viewModel.afterLoadCurrenciesError);\n  },\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./widget-wm-allocations-ng/scripts/service.js"],"sourceRoot":""}