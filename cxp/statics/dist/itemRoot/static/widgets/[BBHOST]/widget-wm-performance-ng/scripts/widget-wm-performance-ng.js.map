{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6*****************************","webpack:///webpack/bootstrap d0309a746b17cd403690?c295*****************************","webpack:///./widget-wm-performance-ng/model.xml","webpack:///external \"lib-bb-state-container-ng\"?8d56***","webpack:///external \"lib-wm-portfolio-view-model-helper\"?8f7a***","webpack:///external \"vendor-bb-angular\"?a114********","webpack:///external \"lib-bb-widget-extension-ng\"?b547*","webpack:///external \"model-wm-portfolio-summary-ng\"?e4f4*","webpack:///./widget-wm-performance-ng/scripts/index.js","webpack:///./widget-wm-performance-ng/scripts/controller.js","webpack:///./widget-wm-performance-ng/scripts/view-model.js","webpack:///./widget-wm-performance-ng/scripts/service.js"],"names":["viewModelKey","performanceServiceKey","angular","module","modelPortfolioSummaryModuleKey","stateContainerModuleKey","factory","bbStateContainerKey","ViewModel","modelPortfolioSummaryKey","PerformanceService","extensionContextKey","performanceService","controller","Controller","run","viewModel","init","name","PortfolioPerformanceController","model","$ctrl","loadPerformanceChart","setPeriod","period","periodParams","dateFrom","Date","setHours","dateTo","Object","assign","state","getState","errors","initialState","portfolioPerformance","data","loading","portfolioPerformanceError","initialLoading","stateContainer","beforeLoadPerformance","afterLoadPerformanceSuccess","raw","afterLoadPerformanceError","error","code","getSelectedPortfolioId","then","portfolioId","catch"],"mappings":"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","file":"widget-wm-performance-ng/scripts/widget-wm-performance-ng.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lib-bb-state-container-ng\"), require(\"lib-wm-portfolio-view-model-helper\"), require(\"vendor-bb-angular\"), require(\"lib-bb-widget-extension-ng\"), require(\"model-wm-portfolio-summary-ng\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"widget-wm-performance-ng\", [\"lib-bb-state-container-ng\", \"lib-wm-portfolio-view-model-helper\", \"vendor-bb-angular\", \"lib-bb-widget-extension-ng\", \"model-wm-portfolio-summary-ng\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"widget-wm-performance-ng\"] = factory(require(\"lib-bb-state-container-ng\"), require(\"lib-wm-portfolio-view-model-helper\"), require(\"vendor-bb-angular\"), require(\"lib-bb-widget-extension-ng\"), require(\"model-wm-portfolio-summary-ng\"));\n\telse\n\t\troot[\"widget-wm-performance-ng\"] = factory(root[\"lib-bb-state-container-ng\"], root[\"lib-wm-portfolio-view-model-helper\"], root[\"vendor-bb-angular\"], root[\"lib-bb-widget-extension-ng\"], root[\"model-wm-portfolio-summary-ng\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_86__, __WEBPACK_EXTERNAL_MODULE_88__, __WEBPACK_EXTERNAL_MODULE_93__, __WEBPACK_EXTERNAL_MODULE_125__, __WEBPACK_EXTERNAL_MODULE_126__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d0309a746b17cd403690","module.exports = require(\"./scripts/index.js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./widget-wm-performance-ng/model.xml\n// module id = 0\n// module chunks = 30","module.exports = __WEBPACK_EXTERNAL_MODULE_86__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-state-container-ng\"\n// module id = 86\n// module chunks = 19 28 29 30 31 32 33 34 35 36 37","module.exports = __WEBPACK_EXTERNAL_MODULE_88__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-wm-portfolio-view-model-helper\"\n// module id = 88\n// module chunks = 19 28 29 30 31 32 33 34 35 36 37","module.exports = __WEBPACK_EXTERNAL_MODULE_93__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"vendor-bb-angular\"\n// module id = 93\n// module chunks = 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37","module.exports = __WEBPACK_EXTERNAL_MODULE_125__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lib-bb-widget-extension-ng\"\n// module id = 125\n// module chunks = 28 29 30 31 32 33 34 35 36","module.exports = __WEBPACK_EXTERNAL_MODULE_126__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"model-wm-portfolio-summary-ng\"\n// module id = 126\n// module chunks = 28 29 30 31 32 33 34 35 36 37","/**\n * @module widget-wm-performance-ng\n *\n * @description\n * Portfolio performance widget\n *\n *\n * @example\n *  <div ng-controller=\"PortfolioPerformanceController as $ctrl\">\n *  </div>\n */\n\nimport angular from 'vendor-bb-angular';\nimport { extensionContextKey } from 'lib-bb-widget-extension-ng';\nimport modelPortfolioSummaryModuleKey, { modelPortfolioSummaryKey }\n       from 'model-wm-portfolio-summary-ng';\nimport stateContainerModuleKey, { bbStateContainerKey } from 'lib-bb-state-container-ng';\nimport Controller from './controller';\nimport ViewModel from './view-model';\nimport PerformanceService from './service';\n\nconst viewModelKey = 'viewModel';\nconst performanceServiceKey = 'performanceService';\n\n/**\n * @name default\n * @type {string}\n * @description Angular module name\n */\nexport default angular\n  .module('widget-wm-performance-ng', [\n    modelPortfolioSummaryModuleKey,\n    stateContainerModuleKey,\n  ])\n\n  .factory(viewModelKey, [bbStateContainerKey, ViewModel])\n  .factory(performanceServiceKey, [modelPortfolioSummaryKey, viewModelKey, PerformanceService])\n  .factory(extensionContextKey, [\n    performanceServiceKey,\n    performanceService => ({ performanceService }),\n  ])\n\n  .controller('PortfolioPerformanceController', [\n    modelPortfolioSummaryKey,\n    viewModelKey,\n    performanceServiceKey,\n    /* into */\n    Controller,\n  ])\n  .run([viewModelKey, viewModel => {\n    viewModel.init();\n  }])\n  .name;\n\n  /**\n * Portfolio cumulative performance\n * @property {object}        period             - Dates period with from date to date values\n * @property {data[]}        chartData          - Data in format suitable for\n *                                                line chart UI component\n */\n\n/**\n * Data object used to draw line performance chart\n * @typedef {object} data\n * @property {date} dateFrom date from of period\n * @property {date} dateTo date to of period\n * @property {number} value point line chart value\n */\n\n/**\n * Dataset object for period\n * @typedef {object} period\n * @property {date} dateFrom date from of period\n * @property {date} dateTo date to of period\n */\n\n\n\n// WEBPACK FOOTER //\n// ./widget-wm-performance-ng/scripts/index.js","/**\n * @name PortfolioPerformanceController\n * @ngkey PortfolioPerformanceController\n * @type {object}\n * @description\n * Porftolio performance controller.\n */\n\nexport default function PortfolioPerformanceController(\n  model,\n  viewModel,\n  performanceService\n) {\n  const $ctrl = this;\n\n  /**\n   * @description\n   * Handles loading of portfolio performance chart\n   *\n   * @private\n   * @name PortfolioPerformanceController#loadPerformanceChart\n   * @type {function}\n   * Load performance chart\n   * @returns {promise.<array>}\n   */\n  const loadPerformanceChart = () => (\n    performanceService.loadPerformanceChart()\n  );\n\n  /**\n   * @description\n   * Sets selected period\n   *\n   * @private\n   * @name PortfolioPerformanceController#setPeriod\n   * @type {function}\n   * @param {string} period Period to load data for\n   */\n  const setPeriod = (period) => {\n    const periodParams = {\n      dateFrom: new Date(new Date(period.dateFrom).setHours(0, 0, 0, 0)),\n      dateTo: new Date(new Date(period.dateTo).setHours(23, 59, 59, 999)),\n    };\n    viewModel.setPeriod(periodParams);\n    return loadPerformanceChart();\n  };\n\n  Object.assign($ctrl, {\n    setPeriod,\n    loadPerformanceChart,\n  });\n\n  return Object.assign(\n    {\n      get state() {\n        return viewModel.getState();\n      },\n      get errors() {\n        return viewModel.getState().errors;\n      },\n    },\n    $ctrl\n  );\n}\n\n\n\n// WEBPACK FOOTER //\n// ./widget-wm-performance-ng/scripts/controller.js","import { wrapActions } from 'lib-wm-portfolio-view-model-helper';\n\n/**\n * @name initialState\n * @description Initial state of widgets store\n * @type {object}\n * @property {object} portfolioPerformance performance initial state object\n *\n * @property {boolean} initialLoading Boolean flag of initial loading\n */\nconst initialState = {\n  portfolioPerformance: {\n    data: null,\n    loading: false,\n    period: {\n      dateFrom: null,\n      dateTo: null,\n    },\n  },\n  errors: {\n    portfolioPerformanceError: null,\n  },\n  initialLoading: true,\n};\n\nexport default (stateContainer) => ({\n  getState: stateContainer.getState,\n  ...wrapActions(stateContainer, {\n    init: (state = initialState) => state,\n    beforeLoadPerformance: () => ({\n      portfolioPerformance: {\n        loading: true,\n      },\n    }),\n    setPeriod: (state, { dateFrom, dateTo }) => (\n      {\n        portfolioPerformance: {\n          period: {\n            dateFrom,\n            dateTo,\n          },\n        },\n      }\n    ),\n    afterLoadPerformanceSuccess: (state, raw) => ({\n      initialLoading: false,\n      portfolioPerformance: {\n        loading: false,\n        data: raw.data,\n      },\n      errors: {\n        portfolioPerformanceError: null,\n      },\n    }),\n    afterLoadPerformanceError: (state, error) => ({\n      initialLoading: false,\n      portfolioPerformance: {\n        loading: false,\n        data: null,\n      },\n      errors: {\n        portfolioPerformanceError: error.code,\n      },\n    }),\n  }),\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./widget-wm-performance-ng/scripts/view-model.js","export default (model, viewModel) => ({\n  /**\n   * @description\n   * Handles loading performance data\n   *\n   * @public\n   * @name PortfolioPerformanceController#loadPerformanceChart\n   * @type {function}\n   * Load performance chart data\n   * @returns {promise.<array>}\n   */\n  loadPerformanceChart: () => {\n    const period = viewModel.getState().portfolioPerformance.period;\n    viewModel.beforeLoadPerformance();\n\n    return model.getSelectedPortfolioId()\n      .then(portfolioId => model.loadPerformanceChart(\n        portfolioId,\n        period.dateFrom,\n        period.dateTo\n      ))\n      .then(viewModel.afterLoadPerformanceSuccess)\n      .catch(viewModel.afterLoadPerformanceError);\n  },\n});\n\n\n\n\n// WEBPACK FOOTER //\n// ./widget-wm-performance-ng/scripts/service.js"],"sourceRoot":""}